@{
    ViewBag.Title = "My Cart";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="display-5 fw-bold" style="font-family: 'Playfair Display', serif;">My Shopping Bag</h1>
        <p class="text-muted">Review your selected beverages</p>
    </div>

    <div id="target">
        <partial name="_ShoppingCart" />
    </div>
</div>

@section foot {
    <script>
        // 1. Auto-submit form when dropdown changes
        $(document).on('change', 'select', function(e) {
            // Fade out to show "Loading..."
            $('#target').css('opacity', '0.5');
            $(e.target.form).submit();
        });

        // 2. NEW: Detect when ANY Ajax request finishes (Update or Delete)
        // This runs automatically after the cart table refreshes
        $(document).ajaxComplete(function() {
            // Fade back in to full visibility
            $('#target').fadeTo(200, 1);
        });
    </script>
}